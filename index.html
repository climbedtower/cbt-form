<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>scrapboxCBT</title>
  <link rel="stylesheet" href="styles.css"><!-- 先ほどのCSSをここにリンク -->
</head>
<body>
  <div class="application_wrapper">
    <div class="create_account_screen">
      <form id="cbt-form" class="create_account_form">

        <!-- 出来事 -->
        <div class="input_group">
          <textarea id="event" class="input" name="event" rows="3" required></textarea>
          <label class="input_label" for="event">
            <span class="label_text">出来事（外部で起きた具体的な事象）</span>
          </label>
        </div>

        <!-- 自動思考 -->
        <div class="input_group">
          <textarea id="thought" class="input" name="thought" rows="2" required></textarea>
          <label class="input_label" for="thought">
            <span class="label_text">自動思考（その瞬間に浮かんだ考え／言葉）</span>
          </label>
        </div>

        <!-- 感情チェックボックス -->
        <div class="checkbox_group">
          <span>感情（該当するものを複数選択）</span>
          <div class="emotion-group">
            <input type="checkbox" id="e1"  name="emotion" value="[||制作完了]">
            <label for="e1">制作完了</label>
            <input type="checkbox" id="e2"  name="emotion" value="[||原点回帰]">
            <label for="e2">原点回帰</label>
            <input type="checkbox" id="e3"  name="emotion" value="[||達成感]">
            <label for="e3">達成感</label>
            <input type="checkbox" id="e4"  name="emotion" value="[||感謝]">
            <label for="e4">感謝</label>
            <input type="checkbox" id="e5"  name="emotion" value="[||安心]">
            <label for="e5">安心</label>
            <input type="checkbox" id="e6"  name="emotion" value="[||過集中]">
            <label for="e6">過集中</label>
            <input type="checkbox" id="e7"  name="emotion" value="[::回避行動]">
            <label for="e7">回避行動</label>
            <input type="checkbox" id="e8"  name="emotion" value="[::罪悪感]">
            <label for="e8">罪悪感</label>
            <input type="checkbox" id="e9"  name="emotion" value="[::対人プレッシャー]">
            <label for="e9">対人プレッシャー</label>
            <input type="checkbox" id="e10" name="emotion" value="[::フリーズ]">
            <label for="e10">フリーズ</label>
            <input type="checkbox" id="e11" name="emotion" value="[::吸収期]">
            <label for="e11">吸収期</label>
            <input type="checkbox" id="e12" name="emotion" value="[::心配]">
            <label for="e12">心配</label>
          </div>
        </div>

        <!-- 行動 -->
        <div class="input_group">
          <textarea id="action" class="input" name="action" rows="2" required></textarea>
          <label class="input_label" for="action">
            <span class="label_text">行動（実際にとった行動や態度）</span>
          </label>
        </div>

        <!-- 結果 -->
        <div class="input_group">
          <textarea id="result" class="input" name="result" rows="2" required></textarea>
          <label class="input_label" for="result">
            <span class="label_text">結果（行動によって起こった現実の反応）</span>
          </label>
        </div>

        <!-- リフレーミング -->
        <div class="input_group">
          <textarea id="reframe" class="input" name="reframe" rows="2" required></textarea>
          <label class="input_label" for="reframe">
            <span class="label_text">リフレーミング（他の見方があるとしたら？）</span>
          </label>
        </div>

        <!-- 送信ボタン -->
        <button type="submit" class="button button_wide">送信</button>

      </form>
    </div>
  </div>

  <script>
    document.getElementById('cbt-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const now = new Date();
      const date = `${now.getFullYear()}/${String(now.getMonth()+1).padStart(2,'0')}/${String(now.getDate()).padStart(2,'0')}`;
      const title = encodeURIComponent(`${date}：CBT`);
      const project = 'creategames';
      const emotions = Array.from(this.querySelectorAll('input[name="emotion"]:checked'))
        .map(cb => cb.value).join(' ');
      const lines = [
        `${date}：CBT`,
        `#${date.slice(0,7)}`, '',
        '[- 出来事]', this.elements.event.value, '',
        '[- 自動思考]', this.elements.thought.value, '',
        '[- 感情]', emotions, '',
        '[- 行動]', this.elements.action.value, '',
        '[- 結果]', this.elements.result.value, '',
        '[- リフレーミング]', this.elements.reframe.value, '',
        '#認知行動療法（CBT） [https://chatgpt.com/c/68095f61-f448-800f-ad49-02eb955c197c?model=gpt-4o]'
      ];
      window.location.href = `https://scrapbox.io/${project}/${title}?body=${encodeURIComponent(lines.join('\n'))}`;
    });
  </script>
</body>
</html>
